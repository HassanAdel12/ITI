@page
@model Day_8.Pages.Student.IndexModel
@{
    ViewBag.Title = "Index";
}

@using Microsoft.AspNetCore.Http;

<p>
    <a asp-page="Create">Create New Student</a>
</p>

<form method="post" asp-Page="Index" asp-route-Search="" asp-page-handler="Search">
    <input type="text" placeholder="Enter Your Search" asp-for="Search"/>
    <button class="btn btn-info">Search</button>
</form>



<br />





@{
    if (TempData["StudentName"] != null)
    {
    <div class="alert alert-dismissible alert-success">
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        <h4 class="alert-heading">Created!</h4>
        <p class="mb-0">@TempData["StudentName"] is Created!</p>
    </div>
    }
}

<br />

@{
    if (HttpContext.Session.Keys.Contains("StudentName"))
    {
    <div class="alert alert-dismissible alert-success">
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        <h4 class="alert-heading">Edited!</h4>
        <p class="mb-0">@HttpContext.Session.GetString("StudentName") is Edited!</p>
    </div>
    }
}

<br />

<h2>Student</h2>

<table class="table">
    <tr>
        <th>
            Id
        </th>
        <th>
            Full Name
        </th>
        <th>
            Graduated
        </th>
        <th>
            Gpa
        </th>
        <th>
            City
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model.Students)
    {
        <tr>

            <td>
                @item.Id
            </td>
            <td>
                @item.FullName
            </td>
            <td>
                @item.Graduated
            </td>
            <td>
                @item.Gpa
            </td>
            <td>
                @item.City.Name
            </td>
            <td>
                <a asp-page="Edit" asp-route-id="@item.Id" class="btn btn-primary">Edit</a> |
                <form method="post" asp-Page="Index" asp-route-id="@item.Id" asp-page-handler="Delete">
                    <button class="btn btn-danger">Delete</button>
                </form>
                
            </td>
        </tr>
    }
</table>